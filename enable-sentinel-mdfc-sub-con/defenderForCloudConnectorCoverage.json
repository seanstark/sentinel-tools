{
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workbookDisplayName": {
      "type": "string",
      "defaultValue": "Defender for Cloud Connector Coverage",
      "metadata": {
        "description": "The friendly name for the workbook that is used in the Gallery or Saved List.  This name must be unique within a resource group."
      }
    },
    "workbookType": {
      "type": "string",
      "defaultValue": "sentinel",
      "metadata": {
        "description": "The gallery that the workbook will been shown under. Supported values include workbook, tsg, etc. Usually, this is 'workbook'"
      }
    },
    "workbookSourceId": {
      "type": "string",
      "defaultValue": "/subscriptions/ada06e68-375e-4210-be3a-c6cacebf41c5/resourcegroups/sentinel-prd/providers/microsoft.operationalinsights/workspaces/sentinel-prd",
      "metadata": {
        "description": "The id of resource instance to which the workbook will be associated"
      }
    },
    "workbookId": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "metadata": {
        "description": "The unique guid for this workbook instance"
      }
    }
  },
  "resources": [
    {
      "name": "[parameters('workbookId')]",
      "type": "microsoft.insights/workbooks",
      "location": "[resourceGroup().location]",
      "apiVersion": "2021-03-08",
      "dependsOn": [],
      "kind": "shared",
      "properties": {
        "displayName": "[parameters('workbookDisplayName')]",
        "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"ccd5adcd-8d59-4cfe-99ec-98075de2e253\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"DefaultSubscription_Internal\",\"type\":1,\"isRequired\":true,\"query\":\"where type =~ 'microsoft.operationalinsights/workspaces'\\r\\n| take 1\\r\\n| project subscriptionId\",\"crossComponentResources\":[\"value::selected\"],\"isHiddenWhenLocked\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\"},{\"id\":\"1ca69445-60fc-4806-b43d-ac7e6aad630a\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Subscription\",\"type\":6,\"query\":\"summarize by subscriptionId\\r\\n| project value = strcat(\\\"/subscriptions/\\\", subscriptionId), label = subscriptionId, selected = iff(subscriptionId =~ '{DefaultSubscription_Internal}', true, false)\\r\\n\",\"crossComponentResources\":[\"value::selected\"],\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\"},{\"id\":\"e94aafa3-c5d9-4523-89f0-4e87aa754511\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Workspace\",\"type\":5,\"query\":\"where type =~ 'microsoft.operationalinsights/workspaces'\\n| project id\",\"crossComponentResources\":[\"{Subscription}\"],\"value\":\"/subscriptions/ada06e68-375e-4210-be3a-c6cacebf41c5/resourceGroups/sentinel-prd/providers/Microsoft.OperationalInsights/workspaces/sentinel-prd\",\"typeSettings\":{\"resourceTypeFilter\":{\"microsoft.operationalinsights/workspaces\":true},\"additionalResourceOptions\":[]},\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\"},{\"id\":\"eafaa0ec-7c3a-4ee5-babe-9850080c909d\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"resourceGroup\",\"type\":1,\"query\":\"resources\\r\\n| where type =~ 'microsoft.operationalinsights/workspaces'\\r\\n| where id == \\\"{Workspace}\\\"\\r\\n| project resourceGroup\",\"crossComponentResources\":[\"value::selected\"],\"isHiddenWhenLocked\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\"},{\"id\":\"ba423df4-f83c-495f-8d57-b3b828f8f11c\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"WorkspaceName\",\"type\":1,\"query\":\"resources\\r\\n| where type =~ 'microsoft.operationalinsights/workspaces'\\r\\n| where id == \\\"{Workspace}\\\"\\r\\n| project name\",\"crossComponentResources\":[\"{Subscription}\"],\"isHiddenWhenLocked\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\"},{\"id\":\"220c32e3-0fd9-4047-81ec-6e8c17b27458\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"timeRange\",\"label\":\"Time Range\",\"type\":4,\"value\":{\"durationMs\":2592000000},\"typeSettings\":{\"selectableValues\":[{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}],\"allowCustom\":true}},{\"id\":\"13a91d3f-a588-4db8-88ab-4395610784b0\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"ShowHelp\",\"label\":\"Show Help\",\"type\":10,\"description\":\"This will show some help information to help you understand the steps required\",\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"jsonData\":\"[\\r\\n    {\\\"value\\\": \\\"Yes\\\", \\\"label\\\": \\\"Yes\\\"},\\r\\n    {\\\"value\\\": \\\"No\\\", \\\"label\\\": \\\"No\\\", \\\"selected\\\":true}\\r\\n]\"},{\"id\":\"093aa952-9149-4588-bfee-e41755eb0ca0\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"ShowHiddenObjects\",\"type\":10,\"isRequired\":true,\"isGlobal\":true,\"isHiddenWhenLocked\":true,\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"jsonData\":\"[\\r\\n    { \\\"value\\\":\\\"Yes\\\", \\\"label\\\":\\\"Yes\\\"},\\r\\n    { \\\"value\\\":\\\"No\\\", \\\"label\\\":\\\"No\\\",\\\"selected\\\":true }\\r\\n]\"},{\"id\":\"41425abc-45e0-4d2c-a9da-d1bedf517025\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"showChangeLog\",\"label\":\"Show Change Log\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\r\\n    {\\\"value\\\": \\\"Yes\\\", \\\"label\\\": \\\"Yes\\\"},\\r\\n    {\\\"value\\\": \\\"No\\\", \\\"label\\\": \\\"No\\\", \\\"selected\\\":true}\\r\\n]\"}],\"style\":\"above\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"parameters - 1\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"ARMEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"GET\\\",\\\"path\\\":\\\"/subscriptions\\\",\\\"urlParams\\\":[{\\\"key\\\":\\\"api-version\\\",\\\"value\\\":\\\"2020-01-01\\\"}],\\\"batchDisabled\\\":false,\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value\\\",\\\"columns\\\":[]}}]}\",\"size\":4,\"queryType\":12},\"conditionalVisibility\":{\"parameterName\":\"ShowHiddenObjects\",\"comparison\":\"isEqualTo\",\"value\":\"Yes\"},\"name\":\"All Subscriptions\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"ARMEndpoint/1.0\\\",\\\"data\\\":null,\\\"headers\\\":[],\\\"method\\\":\\\"GET\\\",\\\"path\\\":\\\"/{Subscription}/resourceGroups/{resourceGroup}/providers/Microsoft.OperationalInsights/workspaces/{WorkspaceName}/providers/Microsoft.SecurityInsights/dataConnectors\\\",\\\"urlParams\\\":[{\\\"key\\\":\\\"api-version\\\",\\\"value\\\":\\\"2021-10-01\\\"}],\\\"batchDisabled\\\":false,\\\"transformers\\\":[{\\\"type\\\":\\\"jsonpath\\\",\\\"settings\\\":{\\\"tablePath\\\":\\\"$.value[?((@.kind=='AzureSecurityCenter'))]\\\",\\\"columns\\\":[{\\\"path\\\":\\\"$.properties.subscriptionId\\\",\\\"columnid\\\":\\\"subscriptionId\\\",\\\"columnType\\\":\\\"string\\\"},{\\\"path\\\":\\\"$.properties.dataTypes.alerts.state\\\",\\\"columnid\\\":\\\"Connected\\\",\\\"columnType\\\":\\\"string\\\"},{\\\"path\\\":\\\"$.name\\\",\\\"columnid\\\":\\\"ConnectorName\\\",\\\"columnType\\\":\\\"string\\\"}]}}]}\",\"size\":4,\"queryType\":12,\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"ShowHiddenObjects\",\"comparison\":\"isEqualTo\",\"value\":\"Yes\"},\"name\":\"Defender for Cloud Connected Subscriptions\"},{\"type\":1,\"content\":{\"json\":\"There is currently not a method to show the Bi-Directional Alert Sync Status for All Subscriptions. \",\"style\":\"info\"},\"name\":\"text - 7\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"Merge/1.0\\\",\\\"merges\\\":[{\\\"id\\\":\\\"089fcd71-f40f-4f78-87de-78eebce1a037\\\",\\\"mergeType\\\":\\\"outer\\\",\\\"leftTable\\\":\\\"All Subscriptions\\\",\\\"rightTable\\\":\\\"Defender for Cloud Connected Subscriptions\\\",\\\"leftColumn\\\":\\\"subscriptionId\\\",\\\"rightColumn\\\":\\\"subscriptionId\\\"}],\\\"projectRename\\\":[{\\\"originalName\\\":\\\"[All Subscriptions].id\\\",\\\"mergedName\\\":\\\"Subscription\\\",\\\"fromId\\\":\\\"089fcd71-f40f-4f78-87de-78eebce1a037\\\"},{\\\"originalName\\\":\\\"[Defender for Cloud Connected Subscriptions].Connected\\\",\\\"mergedName\\\":\\\"Connector Status\\\",\\\"fromId\\\":\\\"unknown\\\"},{\\\"originalName\\\":\\\"[Defender for Cloud Connected Subscriptions].ConnectorName\\\",\\\"mergedName\\\":\\\"Connector Name\\\",\\\"fromId\\\":\\\"unknown\\\"},{\\\"originalName\\\":\\\"[All Subscriptions].subscriptionId\\\",\\\"mergedName\\\":\\\"subscriptionId\\\",\\\"fromId\\\":\\\"089fcd71-f40f-4f78-87de-78eebce1a037\\\"},{\\\"originalName\\\":\\\"[All Subscriptions].tenantId\\\",\\\"mergedName\\\":\\\"tenantId\\\",\\\"fromId\\\":\\\"089fcd71-f40f-4f78-87de-78eebce1a037\\\"},{\\\"originalName\\\":\\\"[All Subscriptions].state\\\",\\\"mergedName\\\":\\\"Subscription State\\\",\\\"fromId\\\":\\\"089fcd71-f40f-4f78-87de-78eebce1a037\\\"},{\\\"originalName\\\":\\\"[All Subscriptions].authorizationSource\\\"},{\\\"originalName\\\":\\\"[All Subscriptions].managedByTenants\\\"},{\\\"originalName\\\":\\\"[All Subscriptions].tenantId\\\"},{\\\"originalName\\\":\\\"[All Subscriptions].displayName\\\"},{\\\"originalName\\\":\\\"[All Subscriptions].subscriptionPolicies\\\"},{\\\"originalName\\\":\\\"[Defender for Cloud Connected Subscriptions].subscriptionId\\\"},{\\\"originalName\\\":\\\"[Defender for Cloud Connected Subscriptions].alertsync\\\"},{\\\"originalName\\\":\\\"[Defender for Cloud Connected Subscriptions].connected\\\"},{\\\"originalName\\\":\\\"[All Subscriptions].tags\\\"}]}\",\"size\":1,\"title\":\"Defender for Cloud Connected Subscriptions\",\"noDataMessage\":\"There doesn't appear to be any subscriptions connected to Sentinel\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":7,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Connector Status\",\"formatter\":0,\"numberFormat\":{\"unit\":0,\"options\":{\"style\":\"decimal\"},\"emptyValCustomText\":\"disabled\"}},{\"columnMatch\":\"Connector Name\",\"formatter\":0,\"numberFormat\":{\"unit\":0,\"options\":{\"style\":\"decimal\"},\"emptyValCustomText\":\"N/A\"}},{\"columnMatch\":\"Bi-directional sync\",\"formatter\":0,\"tooltipFormat\":{\"tooltip\":\"Enabling bi-directional sync will automatically sync the status of Microsoft Sentinel incidents that contain Microsoft Defender alerts with the original alerts in Microsoft Defender.\"}}],\"rowLimit\":1000,\"filter\":true}},\"name\":\"Connected Subscriptions\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"54460a3d-5498-4e1a-93cd-c93f401549a1\",\"cellValue\":\"tabs\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Logic App Audit History\",\"subTarget\":\"logicapps\",\"preText\":\"Logic App Audit History\",\"style\":\"link\"},{\"id\":\"79d2dad1-6d4a-4341-a68f-cae7e2cbd14c\",\"cellValue\":\"tabs\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Azure Activity Audit History\",\"subTarget\":\"azureactivity\",\"style\":\"link\"},{\"id\":\"84741e14-338c-4730-b8a4-952eb4224435\",\"cellValue\":\"tabs\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Defender for Cloud Alert History\",\"subTarget\":\"d4fcalert\",\"style\":\"link\"}]},\"name\":\"links - 7\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"DefenderForCloudDataConnector_CL \\r\\n| where type_s == \\\"Microsoft.SecurityInsights/dataConnectors\\\"\\r\\n| project TimeGenerated, SourceSystem, properties_subscriptionId_g, type_s, kind_s, properties_dataTypes_alerts_state_s\",\"size\":4,\"title\":\"Defender for Cloud Data Connector Changes\",\"timeContextFromParameter\":\"timeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"properties_subscriptionId_g\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}}],\"sortBy\":[{\"itemKey\":\"SourceSystem\",\"sortOrder\":2}],\"labelSettings\":[{\"columnId\":\"properties_subscriptionId_g\",\"label\":\"Subscription\"},{\"columnId\":\"type_s\",\"label\":\"Type\"},{\"columnId\":\"kind_s\",\"label\":\"Setting\"},{\"columnId\":\"properties_dataTypes_alerts_state_s\",\"label\":\"Status\"}]},\"sortBy\":[{\"itemKey\":\"SourceSystem\",\"sortOrder\":2}]},\"name\":\"query - 5 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"DefenderForCloudDataConnector_CL \\r\\n| where type_s == \\\"Microsoft.Security/settings\\\"\\r\\n| project TimeGenerated, SourceSystem, id_s, name_s, kind_s, properties_enabled_b\",\"size\":4,\"title\":\"Bi-Directional Alert Sync Changes\",\"timeContextFromParameter\":\"timeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"SourceSystem\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"18ch\"}},{\"columnMatch\":\"id_s\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}}],\"sortBy\":[{\"itemKey\":\"SourceSystem\",\"sortOrder\":2}],\"labelSettings\":[{\"columnId\":\"id_s\",\"label\":\"Subscription\"},{\"columnId\":\"name_s\",\"label\":\"Name\"},{\"columnId\":\"kind_s\",\"label\":\"Setting\"},{\"columnId\":\"properties_enabled_b\",\"label\":\"Enabled\"}]},\"sortBy\":[{\"itemKey\":\"SourceSystem\",\"sortOrder\":2}]},\"name\":\"query - 5\"}]},\"conditionalVisibility\":{\"parameterName\":\"tabs\",\"comparison\":\"isEqualTo\",\"value\":\"logicapps\"},\"name\":\"Logic App Audit History\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"a1b107ac-ecf7-466f-b57a-56241c4f6d4a\",\"cellValue\":\"aztabs\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Bi-Directional Alert Sync Audit History\",\"subTarget\":\"alertsync\",\"preText\":\"Logic App Audit History\",\"style\":\"link\"},{\"id\":\"a2390e0b-263d-4128-81b5-070df5b95a86\",\"cellValue\":\"aztabs\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Data Connector Audit History\",\"subTarget\":\"dataconnector\",\"style\":\"link\"}]},\"name\":\"links - 7 - Copy\"},{\"type\":1,\"content\":{\"json\":\"The Azure Activity Logs do not contain event details that show Bi-Directional Sync Property Specific changes. The results below do reflect changes to the settings/sentinel namespace. \",\"style\":\"info\"},\"conditionalVisibility\":{\"parameterName\":\"aztabs\",\"comparison\":\"isEqualTo\",\"value\":\"alertsync\"},\"name\":\"text - 3 - Copy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AzureActivity \\r\\n| where ActivityStatusValue == \\\"Success\\\"\\r\\n| where OperationNameValue == \\\"MICROSOFT.SECURITY/SETTINGS/WRITE\\\"\\r\\n| where parse_json(Properties).entity contains \\\"settings/sentinel\\\"\\r\\n| extend entity = tostring(parse_json(Properties).entity)\\r\\n| extend message = tostring(parse_json(Properties).message)\\r\\n| extend role = tostring(parse_json(tostring(parse_json(Authorization).evidence)).role)\\r\\n| extend principalType = tostring(parse_json(tostring(parse_json(Authorization).evidence)).principalType)\\r\\n| extend activityStatusValue = tostring(parse_json(Properties).activityStatusValue)\\r\\n| project TimeGenerated, _ResourceId, SubscriptionId, Caller, principalType, role, message, activityStatusValue\",\"size\":0,\"timeContextFromParameter\":\"timeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"SubscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":false}}],\"sortBy\":[{\"itemKey\":\"TimeGenerated\",\"sortOrder\":2}]},\"sortBy\":[{\"itemKey\":\"TimeGenerated\",\"sortOrder\":2}]},\"conditionalVisibility\":{\"parameterName\":\"aztabs\",\"comparison\":\"isEqualTo\",\"value\":\"alertsync\"},\"name\":\"Bi-Directional Alert Sync Changes\"},{\"type\":1,\"content\":{\"json\":\"The Azure Activity Logs do not contain event details to filter for the Defender for Cloud Connector Type. The results below reflect all Data Connector Changes. Use the connectorName and Connector Details values to narrow down results for the Defender for Cloud Connector\",\"style\":\"info\"},\"conditionalVisibility\":{\"parameterName\":\"aztabs\",\"comparison\":\"isEqualTo\",\"value\":\"dataconnector\"},\"name\":\"text - 3\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"AzureActivity \\r\\n| where ActivityStatusValue == \\\"Success\\\"\\r\\n| where OperationNameValue contains \\\"Microsoft.SecurityInsights/dataConnectors/write\\\" or OperationNameValue contains \\\"Microsoft.SecurityInsights/dataConnectors/delete\\\"\\r\\n| where ResourceGroup contains @\\\"{resourceGroup}\\\"\\r\\n| extend entity = tostring(parse_json(Properties).entity)\\r\\n| extend message = tostring(parse_json(Properties).message)\\r\\n| extend role = tostring(parse_json(tostring(parse_json(Authorization).evidence)).role)\\r\\n| extend principalType = tostring(parse_json(tostring(parse_json(Authorization).evidence)).principalType)\\r\\n| extend activityStatusValue = tostring(parse_json(Properties).activityStatusValue)\\r\\n| extend connectorName = split(tostring(parse_json(Properties).resource), '/')[-1]\\r\\n| project TimeGenerated, connectorName, _ResourceId, SubscriptionId, Caller, principalType, role, message, activityStatusValue\",\"size\":0,\"timeContextFromParameter\":\"timeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"_ResourceId\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"Resource\",\"linkLabel\":\"More Details\",\"linkIsContextBlade\":true}},{\"columnMatch\":\"SubscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":false}}],\"sortBy\":[{\"itemKey\":\"TimeGenerated\",\"sortOrder\":2}],\"labelSettings\":[{\"columnId\":\"_ResourceId\",\"label\":\"Connector Details\"}]},\"sortBy\":[{\"itemKey\":\"TimeGenerated\",\"sortOrder\":2}]},\"conditionalVisibility\":{\"parameterName\":\"aztabs\",\"comparison\":\"isEqualTo\",\"value\":\"hidden\"},\"name\":\"Data Connector Audit History\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"Merge/1.0\\\",\\\"merges\\\":[{\\\"id\\\":\\\"9021be22-b1d0-4912-8549-df909b0dd197\\\",\\\"mergeType\\\":\\\"innerunique\\\",\\\"leftTable\\\":\\\"Data Connector Audit History\\\",\\\"rightTable\\\":\\\"Defender for Cloud Connected Subscriptions\\\",\\\"leftColumn\\\":\\\"connectorName\\\",\\\"rightColumn\\\":\\\"ConnectorName\\\"}],\\\"projectRename\\\":[{\\\"originalName\\\":\\\"[Data Connector Audit History].TimeGenerated\\\",\\\"mergedName\\\":\\\"TimeGenerated\\\",\\\"fromId\\\":\\\"9021be22-b1d0-4912-8549-df909b0dd197\\\"},{\\\"originalName\\\":\\\"[Data Connector Audit History].SubscriptionId\\\",\\\"mergedName\\\":\\\"SubscriptionId\\\",\\\"fromId\\\":\\\"9021be22-b1d0-4912-8549-df909b0dd197\\\"},{\\\"originalName\\\":\\\"[Data Connector Audit History].connectorName\\\",\\\"mergedName\\\":\\\"connectorName\\\",\\\"fromId\\\":\\\"9021be22-b1d0-4912-8549-df909b0dd197\\\"},{\\\"originalName\\\":\\\"[Data Connector Audit History]._ResourceId\\\",\\\"mergedName\\\":\\\"Connector Details\\\",\\\"fromId\\\":\\\"9021be22-b1d0-4912-8549-df909b0dd197\\\"},{\\\"originalName\\\":\\\"[Data Connector Audit History].Caller\\\",\\\"mergedName\\\":\\\"Caller\\\",\\\"fromId\\\":\\\"9021be22-b1d0-4912-8549-df909b0dd197\\\"},{\\\"originalName\\\":\\\"[Data Connector Audit History].principalType\\\",\\\"mergedName\\\":\\\"principalType\\\",\\\"fromId\\\":\\\"9021be22-b1d0-4912-8549-df909b0dd197\\\"},{\\\"originalName\\\":\\\"[Data Connector Audit History].role\\\",\\\"mergedName\\\":\\\"role\\\",\\\"fromId\\\":\\\"9021be22-b1d0-4912-8549-df909b0dd197\\\"},{\\\"originalName\\\":\\\"[Data Connector Audit History].message\\\",\\\"mergedName\\\":\\\"message\\\",\\\"fromId\\\":\\\"9021be22-b1d0-4912-8549-df909b0dd197\\\"},{\\\"originalName\\\":\\\"[Data Connector Audit History].activityStatusValue\\\",\\\"mergedName\\\":\\\"activityStatusValue\\\",\\\"fromId\\\":\\\"9021be22-b1d0-4912-8549-df909b0dd197\\\"},{\\\"originalName\\\":\\\"[Defender for Cloud Connected Subscriptions].ConnectorName\\\"},{\\\"originalName\\\":\\\"[Defender for Cloud Connected Subscriptions].Connected\\\"},{\\\"originalName\\\":\\\"[Defender for Cloud Connected Subscriptions].subscriptionId\\\"}]}\",\"size\":0,\"queryType\":7,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"connectorName\",\"formatter\":7,\"formatOptions\":{\"linkColumn\":\"Connector Details\",\"linkTarget\":\"Resource\",\"linkIsContextBlade\":true}},{\"columnMatch\":\"Connector Details\",\"formatter\":5},{\"columnMatch\":\"SubscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}}]}},\"conditionalVisibility\":{\"parameterName\":\"aztabs\",\"comparison\":\"isEqualTo\",\"value\":\"dataconnector\"},\"showPin\":false,\"name\":\"query - 5\"}]},\"conditionalVisibility\":{\"parameterName\":\"tabs\",\"comparison\":\"isEqualTo\",\"value\":\"azureactivity\"},\"name\":\"Azure Activity\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityAlert\\r\\n| where ProductName == \\\"Azure Security Center\\\"\\r\\n//| project TimeGenerated, WorkspaceSubscriptionId, ResourceId, AlertName, AlertLink, AlertSeverity, IsIncident, Status, Tactics, \",\"size\":0,\"timeContext\":{\"durationMs\":2592000000},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{Workspace}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"AlertLink\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"OpenBlade\",\"linkIsContextBlade\":true,\"bladeOpenContext\":{\"bladeName\":\"AlertBlade\",\"extensionName\":\"Microsoft_Azure_Security_AzureDefenderForData\",\"bladeParameters\":[{\"name\":\"alertId\",\"source\":\"column\",\"value\":\"\"},{\"name\":\"location\",\"source\":\"column\",\"value\":\"\"},{\"name\":\"subscriptionId\",\"source\":\"column\",\"value\":\"\"},{\"name\":\"alertId\",\"source\":\"static\",\"value\":\"2517451914195610220_da637927063401544744_970123933:2f425c6eefae73c50ded4a3eac6753e509316f3d98c53bba5473f76c7d447e26:WS3602856d-3cf5-497b-8c0c-ae7314760cd4\"},{\"name\":\"subscriptionId\",\"source\":\"static\",\"value\":\"3602856d-3cf5-497b-8c0c-ae7314760cd4\"},{\"name\":\"resourceGroup\",\"source\":\"column\",\"value\":\"LimaTeam\"},{\"name\":\"referencedFrom\",\"source\":\"static\",\"value\":\"alertDeepLink\"},{\"name\":\"location\",\"source\":\"static\",\"value\":\"centralus\"}]}}}]}},\"name\":\"query - 0\"}]},\"conditionalVisibility\":{\"parameterName\":\"tabs\",\"comparison\":\"isEqualTo\",\"value\":\"d4fcalert\"},\"name\":\"Defender for Cloud Alert History\"}],\"isLocked\":false,\"fallbackResourceIds\":[\"/subscriptions/ada06e68-375e-4210-be3a-c6cacebf41c5/resourcegroups/sentinel-prd/providers/microsoft.operationalinsights/workspaces/sentinel-prd\"],\"fromTemplateId\":\"sentinel-UserWorkbook\"}",
        "version": "1.0",
        "sourceId": "[parameters('workbookSourceId')]",
        "category": "[parameters('workbookType')]"
      }
    }
  ],
  "outputs": {
    "workbookId": {
      "type": "string",
      "value": "[resourceId( 'microsoft.insights/workbooks', parameters('workbookId'))]"
    }
  },
  "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"
}